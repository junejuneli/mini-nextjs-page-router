# Mini Next.js Page Router

> ä¸€ä¸ªçº¦ 700 è¡Œä»£ç çš„ç®€åŒ–ç‰ˆ Next.js Page Router å®ç°ï¼Œç”¨äºæ·±å…¥ç†è§£ Next.js çš„æ ¸å¿ƒæ¶æ„å’Œå·¥ä½œåŸç†ã€‚

ä¸­æ–‡æ–‡æ¡£ | [English](./README_EN.md)

## ğŸ¯ å­¦ä¹ ç›®æ ‡

é€šè¿‡ç®€æ˜“ä»£ç å®ç° Next.js Page Router æ ¸å¿ƒåŠŸèƒ½ï¼Œç†è§£ç°ä»£ SSR æ¡†æ¶çš„å·¥ä½œåŸç†ï¼š

- âœ… åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è·¯ç”±ç³»ç»Ÿ
- âœ… SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰å’Œ SSGï¼ˆé™æ€ç”Ÿæˆï¼‰
- âœ… React æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯hydrate
- âœ… æ•°æ®è·å– APIï¼ˆgetStaticPropsã€getServerSidePropsã€getStaticPathsï¼‰
- âœ… å®¢æˆ·ç«¯è·¯ç”±å¯¼èˆªï¼ˆSPA ä½“éªŒï¼‰
- âœ… åµŒå¥—åŠ¨æ€è·¯ç”±ï¼ˆå¤šçº§å‚æ•°ï¼‰

## ğŸ“ æ ¸å¿ƒç›®å½•

```
demo/
â”œâ”€â”€ build/          # æ„å»ºç³»ç»Ÿ (æ‰«æé¡µé¢ã€ç”Ÿæˆè·¯ç”±ã€é¢„æ¸²æŸ“)
â”œâ”€â”€ server/         # æœåŠ¡ç«¯ (HTTP æœåŠ¡å™¨ã€è·¯ç”±åŒ¹é…ã€SSR/SSG æ¸²æŸ“)
â”œâ”€â”€ client/         # å®¢æˆ·ç«¯ (hydrateã€è·¯ç”±å™¨ã€Link ç»„ä»¶)
â”œâ”€â”€ pages/          # é¡µé¢ç›®å½• (è‡ªåŠ¨æ˜ å°„ä¸ºè·¯ç”±)
â””â”€â”€ .next/          # æ„å»ºè¾“å‡º
```

**æ–‡æ¡£**ï¼š
- `MINI_NEXTJS_ARCHITECTURE.md` - è¯¦ç»†æ¶æ„è¯´æ˜
- `NEXTJS_PERFORMANCE_OPTIMIZATIONS.md` - Next.js æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. æ„å»ºé¡¹ç›®
npm run build

# 3. å¯åŠ¨æœåŠ¡å™¨
npm start
```

è®¿é—® http://localhost:3000

**ä½“éªŒåŠŸèƒ½**ï¼š
- `/` - SSRï¼ˆæ¯æ¬¡åˆ·æ–°æ•°æ®æ›´æ–°ï¼‰
- `/about` - SSGï¼ˆé¢„æ¸²æŸ“é™æ€é¡µé¢ï¼‰
- `/blog/tech/1` - åµŒå¥—åŠ¨æ€è·¯ç”±

> ç‚¹å‡»é“¾æ¥ - å®¢æˆ·ç«¯è·¯ç”±ï¼ˆæ— åˆ·æ–°ï¼‰

## ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ

### SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰
```jsx
// pages/index.jsx - æ¯æ¬¡è¯·æ±‚æ—¶è¿è¡Œ
export async function getServerSideProps() {
  return { props: { data: await fetchData() } }
}
```

### SSGï¼ˆé™æ€ç”Ÿæˆï¼‰
```jsx
// pages/about.jsx - æ„å»ºæ—¶è¿è¡Œä¸€æ¬¡
export async function getStaticProps() {
  return { props: { data: await fetchData() } }
}
```

### åŠ¨æ€è·¯ç”±
```jsx
// pages/blog/[id].jsx
export async function getStaticPaths() {
  return { paths: [{ params: { id: '1' } }] }
}
```

### åµŒå¥—åŠ¨æ€è·¯ç”± âœ¨
```jsx
// pages/blog/[category]/[id].jsx
export async function getStaticPaths() {
  return {
    paths: [{ params: { category: 'tech', id: '1' } }]
  }
}
```

### å®¢æˆ·ç«¯å¯¼èˆª
```jsx
import Link from '../client/link.jsx'

<Link href="/about">About</Link>  // æ— åˆ·æ–°å¯¼èˆª
```

## ğŸ” å·¥ä½œåŸç†

### æ„å»ºæµç¨‹
```
æ‰«æ pages/ â†’ ç”Ÿæˆè·¯ç”± â†’ Vite æ„å»º â†’ é¢„æ¸²æŸ“ SSG â†’ ä¿å­˜ manifest.json
```

### æœåŠ¡å™¨å¤„ç†
```
è¯·æ±‚ â†’ è·¯ç”±åŒ¹é… â†’ SSG (è¯»æ–‡ä»¶) / SSR (åŠ¨æ€æ¸²æŸ“) â†’ è¿”å› HTML
```

### å®¢æˆ·ç«¯hydrate
```
è¯»å– __NEXT_DATA__ â†’ åŠ¨æ€åŠ è½½ç»„ä»¶ â†’ hydrateRoot â†’ é™„åŠ äº‹ä»¶
```

### å®¢æˆ·ç«¯å¯¼èˆª
```
Link ç‚¹å‡» â†’ fetch JSON â†’ åŠ è½½ç»„ä»¶ â†’ æ›´æ–° DOM â†’ pushState
```

> è¯¦ç»†è¯´æ˜è§ `MINI_NEXTJS_ARCHITECTURE.md`

## ğŸ“– å­¦ä¹ è·¯å¾„

1. **è¿è¡Œé¡¹ç›®** - ä½“éªŒåŸºæœ¬åŠŸèƒ½
2. **é˜…è¯»æ¶æ„æ–‡æ¡£** - `MINI_NEXTJS_ARCHITECTURE.md`
3. **è¿½è¸ªè¯·æ±‚æµç¨‹** - å¼€å‘è€…å·¥å…·è§‚å¯Ÿ SSR/SSG
4. **ç†è§£æ„å»ºæµç¨‹** - æŸ¥çœ‹ `.next/` è¾“å‡ºæ–‡ä»¶
5. **ç†è§£å®¢æˆ·ç«¯å¯¼èˆª** - è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
6. **ä¿®æ”¹å’Œå®éªŒ** - æ·»åŠ æ–°é¡µé¢ã€ä¿®æ”¹é€»è¾‘

**å®éªŒå»ºè®®**ï¼š
- æ·»åŠ æ–°çš„ SSG é¡µé¢
- åˆ›å»ºåµŒå¥—åŠ¨æ€è·¯ç”± `/products/[brand]/[id]`
- å¯¹æ¯” SSR å’Œ SSG çš„æ„å»ºè¾“å‡º

## ğŸ†š ä¸çœŸå® Next.js å¯¹æ¯”

| ç‰¹æ€§ | Mini Next.js | çœŸå® Next.js |
|------|--------------|--------------|
| ä»£ç é‡ | ~700 è¡Œ | ~50 ä¸‡è¡Œ+ |
| æ ¸å¿ƒè·¯ç”± | âœ… | âœ… + ä¸­é—´ä»¶ + App Router |
| SSR/SSG | âœ… | âœ… + ISR + Streaming |
| å®¢æˆ·ç«¯è·¯ç”± | âœ… åŸºç¡€ | âœ… + æ™ºèƒ½é¢„å– |
| åµŒå¥—åŠ¨æ€è·¯ç”± | âœ… | âœ… + Catch-all |
| æ€§èƒ½ä¼˜åŒ– | âš ï¸ åŸºç¡€ | âœ… å›¾ç‰‡/å­—ä½“/è„šæœ¬ä¼˜åŒ– |

> è¯¦ç»†å¯¹æ¯”è§ `NEXTJS_PERFORMANCE_OPTIMIZATIONS.md`

## ğŸ’¡ å­¦ä¹ æ”¶è·

**ç†è§£æ ¸å¿ƒåŸç†**ï¼š
- æ–‡ä»¶ç³»ç»Ÿè·¯ç”±å¦‚ä½•æ˜ å°„åˆ° URL
- SSR/SSG çš„åŒºåˆ«å’Œå®ç°æ–¹å¼
- React æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯hydrateæœºåˆ¶
- SPA å®¢æˆ·ç«¯å¯¼èˆªçš„å®ç°åŸç†

**æŠ€æœ¯æ ˆ**ï¼šVite + Express + React 18 + ESM

## ğŸ“ æ•™å­¦è¯´æ˜

è¿™æ˜¯**æ•™å­¦é¡¹ç›®**ï¼Œä¸“æ³¨äºæ ¸å¿ƒæ¦‚å¿µï¼Œçœç•¥äº†ç”Ÿäº§ç¯å¢ƒçš„å¤æ‚æ€§ï¼š
- âŒ æ— å›¾ç‰‡/å­—ä½“ä¼˜åŒ–
- âŒ æ—  HMRï¼ˆçƒ­æ›´æ–°ï¼‰
- âŒ æ—  ISRï¼ˆå¢é‡é™æ€å†ç”Ÿï¼‰
- âŒ æ—  App Router / Middleware
- âŒ æ—  TypeScript / å®Œå–„çš„é”™è¯¯å¤„ç†

**ç›®æ ‡**ï¼šç”¨æœ€å°‘ä»£ç ç†è§£ Next.js æ ¸å¿ƒæœºåˆ¶

## ğŸ“š å‚è€ƒæ–‡æ¡£

- **æ¶æ„è¯´æ˜**ï¼š[MINI_NEXTJS_ARCHITECTURE.md](./MINI_NEXTJS_ARCHITECTURE.md) - è¯¦ç»†æŠ€æœ¯æ¶æ„å’Œå®ç°åŸç†
- **æ€§èƒ½ä¼˜åŒ–**ï¼š[NEXTJS_PERFORMANCE_OPTIMIZATIONS.md](./NEXTJS_PERFORMANCE_OPTIMIZATIONS.md) - Next.js æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”ä¸å®ç°å»ºè®®

## ğŸ“„ è®¸å¯è¯

MIT

---

**Happy Learning! ğŸ‰**

é€šè¿‡è¿™ä¸ªé¡¹ç›®ç†è§£ Next.js æ ¸å¿ƒåŸç†ï¼Œä¸ºæ·±å…¥å­¦ä¹ å’Œä½¿ç”¨ Next.js æ‰“ä¸‹åšå®åŸºç¡€ã€‚
